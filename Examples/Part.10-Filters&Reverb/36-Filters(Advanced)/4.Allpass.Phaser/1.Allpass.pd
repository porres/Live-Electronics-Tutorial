#N canvas 480 83 858 571 12;
#X declare -path else;
#X obj 517 136 rzero_rev~;
#X text 597 135 =;
#X text 598 111 =;
#X obj 529 110 rpole~;
#X obj 584 84 v a;
#X obj 178 175 rpole~;
#X obj 178 150 rzero_rev~;
#X obj 275 126 hsl 128 15 0 0.9999 0 0 \$0-a empty empty -2 -8 0 10
-228856 -1 -1 0 1;
#X floatatom 272 148 5 0 0 0 - - -;
#N canvas 172 85 1026 565 (subpatch) 0;
#X obj 101 101 cnv 15 808 192 empty empty empty 20 12 0 14 -1 -262144
0;
#X text 210 131 0.05;
#X obj 106 201 cnv 15 798 83 empty empty empty 20 12 0 14 -257983 -66577
0;
#X obj 106 115 cnv 15 798 85 empty empty empty 20 12 0 14 -241340 -66577
0;
#N canvas 391 118 975 563 (subpatch) 0;
#X array \$0-Phase 400 float 0;
#X coords 0 1 399 -1 800 170 1 0 0;
#X restore 105 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 100 170 1;
#X restore 123 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 77 170 1;
#X restore 223 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 80 170 1;
#X restore 300 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 102 170 1;
#X restore 380 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 78 170 1;
#X restore 482 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 78 170 1;
#X restore 560 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 103 170 1;
#X restore 638 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 78 170 1;
#X restore 741 114 graph;
#N canvas 0 22 450 278 (subpatch) 0;
#X coords 0 1 100 -1 78 170 1;
#X restore 819 114 graph;
#X coords 0 -1 1 1 810 194 2 100 100;
#X restore 28 299 pd;
#X text 8 303 pi;
#X text 2 470 -pi;
#X text 13 389 0;
#N canvas 279 91 377 231 plot 0;
#X text 45 83 Loop;
#N canvas 385 89 501 411 H(z) 0;
#X obj 43 79 cnv 15 400 120 empty empty empty 20 12 0 14 -216246 -66577
0;
#X text 275 141 H(z) =;
#X obj 53 44 inlet;
#X obj 98 313 outlet;
#X text 321 138 _______________;
#X text 333 156 1 - a*Z-1;
#X text 337 132 -a + Z-1;
#X obj 98 214 -;
#X obj 53 90 expr -a + cosW_\$0[$f1] \; sinW_\$0[$f1] \; 1 - a * cosW_\$0[$f1]
\; -a * sinW_\$0[$f1];
#X obj 143 162 car2pol;
#X obj 53 159 car2pol;
#X obj 98 275 wrap2 -1 1;
#X obj 98 249 /;
#X obj 131 215 pi;
#X text 101 337 Phase;
#X text 98 44 Index;
#X text 280 106 Transfer Function;
#X connect 2 0 8 0;
#X connect 7 0 12 0;
#X connect 8 0 10 0;
#X connect 8 1 10 1;
#X connect 8 2 9 0;
#X connect 8 3 9 1;
#X connect 9 1 7 1;
#X connect 10 1 7 0;
#X connect 11 0 3 0;
#X connect 12 0 11 0;
#X connect 13 0 12 1;
#X restore 79 138 pd H(z);
#N canvas 259 145 472 201 init 0;
#X obj 118 76 samplerate~;
#X obj 118 99 v sr;
#N canvas 760 51 335 250 get-freq 0;
#X obj 88 29 inlet;
#N canvas 192 80 563 633 loop 0;
#X obj 54 192 until;
#X obj 92 241 + 1;
#X msg 72 216 0;
#X obj 54 95 t f f;
#X obj 361 216 until;
#X obj 407 265 + 1;
#X msg 379 241 0;
#X obj 54 270 t f f;
#X obj 159 355 +;
#X obj 54 370 mtof;
#X obj 54 144 t f b f;
#X obj 361 191 t f b f;
#X obj 361 326 /;
#X obj 54 31 inlet;
#X obj 54 574 outlet;
#X obj 207 583 outlet;
#X obj 361 265 f;
#X obj 361 379 expr pow($f1 \, 0.4);
#X obj 54 241 f;
#X obj 361 296 trigger f f;
#X obj 361 407 * 20.6017;
#X text 434 407 MIDI 16;
#X obj 54 298 expr (($f1 + 1) * (midi_range_\$0 / $f2)) + 16;
#X obj 54 63 expr rint(400 * 0.98);
#X obj 361 144 expr 400 - $f1;
#X obj 201 197 v midi_range_\$0;
#X obj 201 171 ftom;
#X msg 201 145 8750.55;
#X obj 54 465 expr $f1 * 2*pi / sr;
#X obj 361 498 expr $f1 * 2*pi / sr;
#X connect 0 0 18 0;
#X connect 1 0 18 1;
#X connect 2 0 18 1;
#X connect 3 0 10 0;
#X connect 3 1 24 0;
#X connect 4 0 16 0;
#X connect 5 0 16 1;
#X connect 6 0 16 1;
#X connect 7 0 22 0;
#X connect 7 1 8 0;
#X connect 8 0 15 0;
#X connect 9 0 28 0;
#X connect 10 0 0 0;
#X connect 10 1 2 0;
#X connect 10 1 27 0;
#X connect 10 2 22 1;
#X connect 11 0 4 0;
#X connect 11 1 6 0;
#X connect 11 2 12 1;
#X connect 12 0 17 0;
#X connect 13 0 23 0;
#X connect 16 0 5 0;
#X connect 16 0 19 0;
#X connect 17 0 20 0;
#X connect 18 0 1 0;
#X connect 18 0 7 0;
#X connect 19 0 12 0;
#X connect 19 1 15 0;
#X connect 20 0 29 0;
#X connect 22 0 9 0;
#X connect 23 0 3 0;
#X connect 24 0 8 1;
#X connect 24 0 11 0;
#X connect 26 0 25 0;
#X connect 27 0 26 0;
#X connect 28 0 14 0;
#X connect 29 0 14 0;
#X restore 88 69 pd loop;
#X obj 61 195 tabwrite sinW_\$0;
#X obj 35 159 tabwrite cosW_\$0;
#X obj 35 105 expr cos($f1) \; sin($f1);
#X obj 176 128 table sinW_\$0 400;
#X obj 176 103 table cosW_\$0 400;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 1 1 3 1;
#X connect 1 1 2 1;
#X connect 4 0 3 0;
#X connect 4 1 2 0;
#X restore 96 131 pd get-freq;
#X text 192 130 complex frequencies table;
#X obj 218 74 pi;
#X obj 222 100 v pi;
#X obj 96 31 lb 2;
#X connect 0 0 1 0;
#X connect 4 0 5 0;
#X connect 6 0 2 0;
#X connect 6 1 0 0;
#X connect 6 1 4 0;
#X restore 199 64 pd init \; tables;
#X obj 79 60 t b f;
#X obj 127 62 v a;
#X obj 79 114 trigger f f;
#X obj 79 37 r \$0-a;
#X obj 79 85 loop 400;
#X obj 79 165 tabwrite \$0-Phase;
#X connect 1 0 8 0;
#X connect 3 0 7 0;
#X connect 3 1 4 0;
#X connect 5 0 1 0;
#X connect 5 1 8 1;
#X connect 6 0 3 0;
#X connect 7 0 5 0;
#X restore 786 279 pd plot;
#X obj 178 100 sig~ 100;
#X text 140 497 0.05;
#X text 40 497 0.02;
#X text 744 496 10;
#X text 821 497 20;
#X text 669 496 5;
#X text 566 496 2;
#X text 488 497 1;
#X text 402 497 0.5;
#X text 300 497 0.2;
#X text 220 497 0.1;
#X obj 515 170 fexpr~ -a * $x + $x[-1] + a * $y[-1];
#X obj 619 111 fexpr~ $x + a * $y[-1];
#X obj 616 136 fexpr~ -a * $x + $x[-1];
#X floatatom 357 234 0 0 0 0 - - -;
#X floatatom 438 234 0 0 0 0 - - -;
#X text 440 259 Zero;
#X obj 178 124 bl.saw~;
#X obj 178 215 out~;
#X text 29 276 Phase Response;
#X obj 272 178 f2s~ 10;
#X text 320 153 coefficient;
#X text 552 45 These filter equations and how to merge them in [fexpr~]:
, f 32;
#X text 358 258 Pole;
#X text 452 210 Pole/Zero location;
#N canvas 474 178 355 170 diagram 0;
#X obj 19 23 cnv 15 310 120 empty empty empty 20 12 0 14 -228856 -66577
0;
#X text 36 109 y(n) = -a * x(n) + x(n-1) + a * y(n-1);
#X text 72 37 |;
#X text 72 49 |;
#X text 53 62 |;
#X text 102 62 |;
#X text 102 82 |;
#X text 53 82 |;
#X text 56 51 _______;
#X text 56 82 _______;
#X text 72 52 v;
#X text 127 53 |;
#X text 127 65 |;
#X text 127 41 |;
#X text 127 37 ^;
#X text 219 37 |;
#X text 219 49 |;
#X text 200 62 |;
#X text 249 62 |;
#X text 249 82 |;
#X text 200 82 |;
#X text 203 51 _______;
#X text 203 82 _______;
#X text 219 52 v;
#X text 158 53 |;
#X text 158 65 |;
#X text 158 41 |;
#X text 158 37 ^;
#X text 268 28 >;
#X text 53 72 | z^-1 |;
#X text 200 72 | z^-1 |;
#X text 161 71 -(*a)-;
#X text 32 28 x[n] ---(*-a)--(+)--(+)----------- y[n];
#X text 107 71 ---;
#X restore 650 219 pd diagram;
#N canvas 554 126 283 181 transfer_function 0;
#X obj 28 56 cnv 15 220 90 empty empty empty 20 12 0 14 -261234 -66577
0;
#X text 71 99 H(z) =;
#X text 128 90 -a + z^-1;
#X text 112 96 ________________;
#X text 125 112 1 - a * z^-1;
#N canvas 616 23 501 693 H(z) 0;
#X obj 160 548 cnv 15 220 90 empty empty empty 20 12 0 14 -233017 -66577
0;
#X text 187 588 H(z) =;
#X text 244 579 -a + z^-1;
#X text 169 276 X(z) =;
#X text 212 273 _____________________;
#X text 228 585 ________________;
#X text 131 139 Y(z) = -a * X(z) + X(z)z^-1 + a * Y(z)z^-1;
#X text 141 200 Y(z) - a*Y(z)z^-1 = -a*X(z) + X(z)z^-1;
#X text 143 231 Y(z) - a*Y(z)z^-1 = X(z) * (-a + z^-1);
#X text 223 266 Y(z) - a*Y(z)z^-1;
#X text 240 287 -a + z^-1;
#X text 241 601 1 - a * z^-1;
#X text 131 86 y(n) = -a * x(n) + x(n-1) + a * y(n-1);
#X text 94 332 H(z) = Y(z) / X(z);
#X text 133 378 H(z) =;
#X text 183 393 Y(z) - a*Y(z)z^-1 / (-a + z^-1);
#X text 176 375 _________________________________;
#X text 257 361 Y(z);
#X text 155 458 H(z) =;
#X text 215 471 Y(z) - a*Y(z)z^-1;
#X text 212 446 Y(z) * (-a + z^-1);
#X text 198 455 _______________________;
#X text 171 557 Transfer Function:;
#X text 83 173 Isolate X(z):;
#X text 90 66 Difference equation:;
#X text 86 118 Transfer Function notation:;
#X restore 194 37 pd H(z);
#X text 39 65 Transfer Function:;
#X restore 592 249 pd transfer_function;
#X text 221 534 We don't plot the amplitudes because they are unchanged.
, f 58;
#X obj 651 9 declare -path else;
#X text 41 14 All filters promote phase distortion \, but the allpass
filter only promotes that. A 1st order allpass can be implemented with
[rzero_rev~] & [rpole~]. The Pole & Zero effect on the amplitude gets
cancelled out \, so only the phase is affected and distorted or shifted!
, f 66;
#N canvas 268 208 449 335 Pole-Zero 0;
#X text 249 268 zero 1;
#X obj 357 180 v kIm_\$0;
#X obj 101 182 v kRe_\$0;
#X obj 65 247 outlet;
#X obj 245 247 outlet;
#X obj 101 138 expr if($f1 >= 0 \, sqrt(abs($f1)) \, 0) \; if($f1 <
0 \, sqrt(abs($f1)) \, 0);
#X obj 65 216 expr ($f1 + kRe_\$0) / 2;
#X obj 245 216 expr ($f1 + kRe_\$0) / 2;
#X obj 65 32 r \$0-a;
#X obj 65 63 expr $f1 \; pow($f1 \, 2) \; -1 / -$f1 \; pow(1 / -$f1
\, 2);
#X text 70 267 pole 1;
#X connect 5 0 2 0;
#X connect 5 1 1 0;
#X connect 6 0 3 0;
#X connect 7 0 4 0;
#X connect 8 0 9 0;
#X connect 9 0 6 0;
#X connect 9 1 5 0;
#X connect 9 2 7 0;
#X connect 9 3 5 0;
#X restore 357 210 pd Pole-Zero;
#X connect 4 0 3 1;
#X connect 4 0 0 1;
#X connect 5 0 32 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 34 0;
#X connect 14 0 31 0;
#X connect 31 0 6 0;
#X connect 34 0 6 1;
#X connect 34 0 5 1;
#X connect 44 0 28 0;
#X connect 44 1 29 0;
