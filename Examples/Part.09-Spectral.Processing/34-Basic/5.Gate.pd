#N canvas 469 36 952 604 12;
#X declare -path else;
#X obj 264 350 nbx 5 14 0 1e+37 0 0 empty empty empty 0 -8 0 10 -228856
-1 -1 1 256;
#X text 726 276 signal;
#X obj 702 128 nbx 5 14 0 1e+37 0 0 empty empty empty 0 -8 0 10 -228856
-1 -1 1 256;
#X text 301 411 signal;
#X obj 80 230 noise~;
#N canvas 411 67 503 581 Spectral-Gate(median) 0;
#X obj 227 366 *~;
#X obj 89 22 inlet~;
#X obj 188 367 *~;
#X obj 89 79 rfft~;
#X obj 188 397 rifft~;
#X obj 188 528 outlet~;
#X obj 123 369 *~;
#X obj 84 370 *~;
#X obj 84 400 rifft~;
#X obj 84 528 outlet~;
#X obj 84 429 /~ 1536;
#X obj 357 22 inlet;
#X obj 188 427 /~ 1536;
#X obj 224 76 block~ 1024 4;
#X obj 199 156 mag~ power;
#X obj 89 50 hann~;
#X obj 84 501 hann~;
#X obj 188 498 hann~;
#X obj 199 220 expr~ $v1 < ($v2 * $f3);
#X obj 245 301 expr~ 1 - $v1;
#X obj 278 193 median~ 32;
#X connect 0 0 4 1;
#X connect 1 0 15 0;
#X connect 2 0 4 0;
#X connect 3 0 7 0;
#X connect 3 0 2 0;
#X connect 3 0 14 0;
#X connect 3 1 6 0;
#X connect 3 1 0 0;
#X connect 3 1 14 1;
#X connect 4 0 12 0;
#X connect 6 0 8 1;
#X connect 7 0 8 0;
#X connect 8 0 10 0;
#X connect 10 0 16 0;
#X connect 11 0 18 2;
#X connect 12 0 17 0;
#X connect 14 0 18 0;
#X connect 14 0 20 0;
#X connect 15 0 3 0;
#X connect 16 0 9 0;
#X connect 17 0 5 0;
#X connect 18 0 6 1;
#X connect 18 0 7 1;
#X connect 18 0 19 0;
#X connect 19 0 0 1;
#X connect 19 0 2 1;
#X connect 20 0 18 1;
#X restore 538 443 pd Spectral-Gate(median);
#X obj 530 215 out~;
#X obj 702 216 out~;
#X obj 155 442 out~;
#X obj 264 442 out~;
#N canvas 270 157 566 616 Spectral-Gate 0;
#X obj 111 38 inlet~;
#X obj 40 546 outlet~;
#X obj 111 133 rfft~;
#X obj 40 424 rifft~;
#X obj 40 514 /~ 1536;
#X obj 291 134 block~ 1024 4;
#X obj 40 366 *~;
#X obj 73 366 *~;
#X obj 111 365 *~;
#X obj 144 365 *~;
#X obj 111 547 outlet~;
#X obj 111 425 rifft~;
#X obj 111 522 /~ 1536;
#X obj 162 206 mag~;
#X obj 40 483 hann~;
#X obj 111 489 hann~;
#X obj 162 287 expr~ 1 - $v1;
#X obj 111 93 hann~;
#X obj 162 240 expr~ $v1 < $f2;
#X obj 264 35 inlet;
#X connect 0 0 17 0;
#X connect 2 0 6 0;
#X connect 2 0 8 0;
#X connect 2 0 13 0;
#X connect 2 1 7 0;
#X connect 2 1 9 0;
#X connect 2 1 13 1;
#X connect 3 0 14 0;
#X connect 4 0 1 0;
#X connect 6 0 3 0;
#X connect 7 0 3 1;
#X connect 8 0 11 0;
#X connect 9 0 11 1;
#X connect 11 0 15 0;
#X connect 12 0 10 0;
#X connect 13 0 18 0;
#X connect 14 0 4 0;
#X connect 15 0 12 0;
#X connect 16 0 9 1;
#X connect 16 0 8 1;
#X connect 17 0 2 0;
#X connect 18 0 6 1;
#X connect 18 0 7 1;
#X connect 18 0 16 0;
#X connect 19 0 18 1;
#X restore 155 378 pd Spectral-Gate;
#X text 71 407 noise floor;
#X text 59 115 Here we divide the spectral components above and below
an amplitude threshold. We'll consider the components above as the
signal and the ones below as the noise floor. The first example considers
a threshold., f 49;
#X text 759 127 level;
#N canvas 460 23 558 701 Spectral-Gate(average) 0;
#X obj 198 460 *~;
#X obj 166 46 inlet~;
#X obj 157 461 *~;
#X obj 166 113 rfft~;
#X obj 157 491 rifft~;
#X obj 157 622 outlet~;
#X obj 255 125 block~ 1024 4;
#X obj 104 461 *~;
#X obj 63 462 *~;
#X obj 63 494 rifft~;
#X obj 63 622 outlet~;
#X obj 63 523 /~ 1536;
#X obj 374 48 inlet;
#X obj 157 521 /~ 1536;
#X obj 216 198 mag~;
#X obj 166 84 hann~;
#X obj 63 565 hann~;
#X obj 157 562 hann~;
#X obj 216 402 expr~ 1 - $v1;
#X obj 216 357 expr~ $v1 < ($v2 * $f3);
#X obj 295 251 mov.avg~ 512;
#X connect 0 0 4 1;
#X connect 1 0 15 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 0 8 0;
#X connect 3 0 14 0;
#X connect 3 1 0 0;
#X connect 3 1 7 0;
#X connect 3 1 14 1;
#X connect 4 0 13 0;
#X connect 7 0 9 1;
#X connect 8 0 9 0;
#X connect 9 0 11 0;
#X connect 11 0 16 0;
#X connect 12 0 19 2;
#X connect 13 0 17 0;
#X connect 14 0 19 0;
#X connect 14 0 20 0;
#X connect 15 0 3 0;
#X connect 16 0 10 0;
#X connect 17 0 5 0;
#X connect 18 0 2 1;
#X connect 18 0 0 1;
#X connect 19 0 7 1;
#X connect 19 0 8 1;
#X connect 19 0 18 0;
#X connect 20 0 19 1;
#X restore 530 149 pd Spectral-Gate(average);
#X text 541 278 noise floor;
#X text 480 18 The next example considers an average as the threshold.
A level parameter is multiplied by this average., f 45;
#X obj 703 420 nbx 5 14 0 1e+37 0 0 empty empty empty 0 -8 0 10 -228856
-1 -1 1 256;
#X text 760 419 level;
#X obj 538 490 out~;
#X obj 703 486 out~;
#X obj 137 265 s~ \$0-in;
#X obj 538 415 r~ \$0-in;
#X obj 530 106 r~ \$0-in;
#X obj 155 345 r~ \$0-in;
#X obj 703 393 initmess 1;
#X obj 702 97 initmess 1;
#X obj 264 319 initmess 1;
#X text 726 543 signal;
#X text 545 546 noise floor;
#X obj 90 46 declare -path else;
#X text 324 349 threshold;
#X text 476 320 The last example also uses an average value for the
threshold \, but now it's a median instead of an average. This seems
to work better for extracting tonal peaks., f 55;
#X obj 137 231 play.file~ 1 kantele.wav 1 1;
#X connect 0 0 10 1;
#X connect 2 0 14 1;
#X connect 5 0 19 0;
#X connect 5 1 20 0;
#X connect 10 0 8 0;
#X connect 10 1 9 0;
#X connect 14 0 6 0;
#X connect 14 1 7 0;
#X connect 17 0 5 1;
#X connect 22 0 5 0;
#X connect 23 0 14 0;
#X connect 24 0 10 0;
#X connect 25 0 17 0;
#X connect 26 0 2 0;
#X connect 27 0 0 0;
#X connect 33 0 21 0;
