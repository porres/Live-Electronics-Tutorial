#N canvas 308 56 1013 513 12;
#X declare -path else;
#X obj 819 28 declare -path else;
#X text 531 170 Program Change and Aftertouch only need to be followed by one more value to represent \, respectively \, Program number and Aftertouch value. Let's check all of these in detail below., f 62;
#N canvas 619 54 626 579 Control-Change 0;
#X text 259 462 MIDI channel;
#X obj 236 459 display;
#X obj 188 489 display 3;
#X obj 141 520 display 2;
#X obj 141 431 ctl.in, f 14;
#X text 221 492 Control Number;
#X text 170 523 Control Value;
#X msg 141 303 176 \, 15 \, 77;
#X text 240 288 Control change in channel 1 \; Control Number (15) \; Control value (77), f 29;
#X text 54 32 Control Change messages are composed of 3 bytes., f 66;
#X text 54 53 They start with a first number from 176 to 191 that codifies the MIDI Channel (176 is channel 1 \, 177 is channel 2 and so on)., f 66;
#X text 54 89 The following two bytes represent \, respectively \, control number and control value (whose values are from 0 to 127)., f 66;
#X text 54 125 This gives us 127 different controllers in each channel to set parameters., f 66;
#X text 54 165 Usually \, in MIDI controllers \, control change values are given by sliders and knobs., f 66;
#X text 54 204 Pd Vanilla has a [ctlin] object and the ELSE library has [ctl.in] \, which retrieves control change messages from raw MIDI input., f 66;
#X msg 155 363 178 \, 15 \, 0;
#X text 240 349 Control change in channel 3 \; Control Number (15) \; Control value (0), f 29;
#X connect 4 0 3 0;
#X connect 4 1 2 0;
#X connect 4 2 1 0;
#X connect 7 0 4 0;
#X connect 15 0 4 0;
#X restore 761 247 pd Control-Change;
#N canvas 652 84 574 525 Program-Change 0;
#X text 216 447 MIDI channel;
#X obj 193 444 display;
#X obj 98 475 display 2;
#X text 127 478 Control Value;
#X text 53 32 Program Change messages are composed of 2 bytes., f 66;
#X text 53 113 Program Change values are usually for changing from one program (or "patch" in the Pd world) to another. So you can change timbres in a synth., f 66;
#X text 53 164 Pd Vanilla has a [pgmin] object and note that it outputs values from 1 to 128! The ELSE library has [pgm.in] \, which retrieves program change messages from raw MIDI input. The output is also "raw" in a sense that program number values are from 0 to 127!, f 66;
#X text 53 90 The following byte represents the program number (from 0 to 127)., f 66;
#X text 53 234 Unlike MIDI channels \, that have a standard of being numbered from 1 to 16 \, there's no official standard for Program Change messages \, but it's common to find it numbered from 1 to 128 as in Pd., f 66;
#X obj 98 416 pgm.in, f 14;
#X msg 98 318 192 \, 0;
#X text 151 321 Program change in channel 1 \, Program Value (0);
#X text 53 53 They start with a first number from 192 to 207 that codifies the MIDI Channel (192 is channel 1 \, 193 is channel 2 and so on)., f 66;
#X msg 112 368 199 \, 80;
#X text 175 368 Program change in channel 8 \, Program Value (80);
#X connect 9 0 2 0;
#X connect 9 1 1 0;
#X connect 10 0 9 0;
#X connect 13 0 9 0;
#X restore 613 320 pd Program-Change;
#N canvas 510 80 685 623 Pitch-Bend 0;
#X text 201 534 MIDI channel;
#X obj 178 531 display;
#X obj 97 503 bend.in -raw;
#X text 143 571 Pitch bend;
#X msg 97 342 224 \, 127 \, 127;
#X obj 97 567 display 5;
#X text 46 17 Pitch Bend messages are composed of 3 bytes., f 64;
#X text 46 35 They start with a first number from 224 to 239 that codifies the MIDI Channel (224 is channel 1 \, 225 is channel 2 and so on)., f 81;
#X msg 105 365 224 \, 127 \, 63;
#X text 203 342 Pitch Bend in channel 1 \, Bend values (127 \, 127);
#X text 203 366 Pitch Bend in channel 1 \, Bend values (127 \, 63);
#X msg 120 394 226 \, 97 \, 0;
#X text 203 395 Pitch Bend in channel 3 \, Bend values (97 \, 0);
#X msg 128 458 239 \, 0 \, 0;
#X text 203 459 Pitch Bend in channel 16 \, Bend values (0 \, 0);
#X text 46 272 The way to get the bend value is by summing the first byte value to the second byte value. But the second byte is multiplied by 128!, f 81;
#X msg 127 421 226 \, 0 \, 8;
#X text 46 71 The following two bytes (whose values are from 0 to 127) compose the pitch bend value. Since we have 2 values with 7 bit resolution \, the Pitch Bend messages have a 14 bit resolution (from 0 to 1383). This makes it really special in comparison to the other MIDI message types for its superior resolution., f 81;
#X text 46 141 MIDI controllers usually have a special "wheel like" controller for this. When not in motion \, the wheel sits in the middle and if you slide it forward you have a pitch bend upwards \, whereas it bends the pitch lower otherwise. When you release the wheel \, it gets back to the middle position., f 81;
#X text 46 207 Pd Vanilla has [bendin] and ELSE has [bend.in] (which retrieves pitch bend messages from raw MIDI input). The [bend.in] object outputs values from -1 to 1 \, but with the '-raw' flag \, the output of [bend.in] is from 0 to 16383 (so the mid point would be 8191)., f 81;
#X text 203 422 Pitch Bend in channel 3 \, Bend values (0 \, 8);
#X connect 2 0 5 0;
#X connect 2 1 1 0;
#X connect 4 0 2 0;
#X connect 8 0 2 0;
#X connect 11 0 2 0;
#X connect 13 0 2 0;
#X connect 16 0 2 0;
#X restore 761 320 pd Pitch-Bend;
#N canvas 205 116 1070 588 Note-On/Off 0;
#X text 63 88 Note On Messages start with a number from 144 (in channel 1) to 159 (channel 16)., f 66;
#X text 63 24 Note Off and Note On messages are composed of 3 bytes., f 66;
#X text 63 42 Note off messages start with a first number from 128 to 143 that codifies the MIDI Channel (129 is channel 1 \, 130 is channel 2 and so on)., f 66;
#X text 63 122 The following two bytes for note messages represent \, respectively \, Pitch and Velocity (whose values are from 0 to 127)., f 66;
#X text 63 164 In this tutorial section we've seen that Note Off messages are rare! Usually \, a Note On message with a velocity value of 0 represents a Note Off and this how Pd usually deals with it., f 66;
#X msg 70 328 144 \, 68 \, 120;
#X text 174 466 MIDI channel;
#X obj 151 463 display;
#X msg 94 394 128 \, 68 \, 120;
#X msg 84 351 144 \, 68 \, 0;
#X text 165 328 Note On in channel 1 \, Picth (68) \, Velocity (120);
#X text 165 351 Note On in channel 1 \, Picth (68) \, Velocity (120);
#X text 190 394 Note Off in channel 1 \, Picth (68) \, Velocity (120);
#X text 769 96 Note On (raw MIDI data);
#X text 784 146 Note Off (raw MIDI data);
#X obj 670 206 display;
#X obj 779 206 display 3;
#X text 595 255 Even though you can rarely find a MIDI controller that outputs release velocity nowadays \, a MIDI file can easily contain this data and you can retrieve it in a patch., f 59;
#N canvas 631 232 735 493 release 0;
#X obj 86 49 inlet;
#X obj 86 91 note.in -rel, f 16;
#X obj 139 383 *~;
#X floatatom 157 260 5 0 0 0 - - - 0;
#X obj 86 260 mtof;
#X obj 86 288 osc~;
#X obj 280 276 rescale 10 1000;
#X obj 139 437 outlet~;
#X obj 86 158 unpack;
#X obj 194 190 unpack;
#X msg 189 230 0;
#X obj 157 327 adsr~ 20 10 0.5 10;
#X text 275 96 In this subpatch we deal with Note On and Off messages in order that the Note On Velocity sets intensity and Note Off velocity sets the envelope's release time. A Note On message with velocity of zero is treated as a Note Off Message with a release velocity of 0 as well.;
#X obj 125 188 sel 0;
#X msg 280 233 0;
#X connect 0 0 1 0;
#X connect 1 0 8 0;
#X connect 1 1 9 0;
#X connect 2 0 7 0;
#X connect 3 0 11 0;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 6 0 11 5;
#X connect 8 0 4 0;
#X connect 8 1 13 0;
#X connect 9 0 4 0;
#X connect 9 1 6 0;
#X connect 9 1 10 0;
#X connect 10 0 3 0;
#X connect 11 0 2 1;
#X connect 13 0 10 0;
#X connect 13 0 14 0;
#X connect 13 1 3 0;
#X connect 14 0 6 0;
#X restore 711 473 pd release;
#X obj 711 503 out~;
#X text 595 319 You can use the release velocity \, for instance \, to control the release phase of an envelope. Check the subpatch below.;
#X msg 726 409 144 \, 68 \, 0;
#X text 816 396 <= click;
#X text 833 442 <= click;
#X msg 670 88 144 \, 68 \, 120;
#X msg 684 113 144 \, 68 \, 0;
#X msg 698 146 128 \, 68 \, 88;
#X msg 740 441 128 \, 68 \, 127;
#X msg 712 385 144 \, 68 \, 127;
#X text 792 473 <= open;
#X obj 70 430 note.in -rel;
#X obj 70 526 display;
#X obj 110 494 display;
#X text 125 528 Pitch and velocity for Note On;
#X text 169 496 Pitch and velocity for Note Off;
#X text 64 214 This means that when [notein] receives a MIDI Note Off message with any velocity value (also known as "release velocity") \, Pd translates it to a Note On message with a velocity of 0! The [note.in] object from the ELSE can output both Note On and Note Off messages with the -rel flag \, for instance. Check its help file for more details, f 66;
#X obj 670 177 note.in -both, f 16;
#X text 620 24 With the '-both' flag \, [note.in] outputs both Note On and Note Off velocities in a single list output., f 40;
#X connect 5 0 30 0;
#X connect 8 0 30 0;
#X connect 9 0 30 0;
#X connect 18 0 19 0;
#X connect 21 0 18 0;
#X connect 24 0 36 0;
#X connect 25 0 36 0;
#X connect 26 0 36 0;
#X connect 27 0 18 0;
#X connect 28 0 18 0;
#X connect 30 0 31 0;
#X connect 30 1 32 0;
#X connect 30 2 7 0;
#X connect 36 0 15 0;
#X connect 36 1 16 0;
#X restore 634 247 pd Note-On/Off;
#N canvas 552 131 656 452 Polyphonic-Aftertouch 0;
#X text 197 338 MIDI channel;
#X obj 174 335 display;
#X text 46 17 Poliphonic Aftertouch messages are composed of 3 bytes., f 64;
#X text 46 35 They start with a first number from 160 to 175 that codifies the MIDI Channel (160 is channel 1 \, 161 is channel 2 and so on)., f 81;
#X text 46 71 The following two bytes represent \, respectively \, Pitch and Aftertouch (whose values are from 0 to 127)., f 81;
#X text 46 107 Polyphonic (or "key") Aftertouch (or "pressure") is a control that became rare in modern controllers \, but it used to capture the pressure of each key after you played a note. This allows the synthesizer to add a specific modulation for each key voice. Nowadays the key aftertouch is more present in pad controllers., f 81;
#X obj 114 307 ptouch.in;
#X text 46 173 Pd Vanilla has [polytouch] for polyphonic aftertouch. The ELSE library has [ptouch.in] which outputs the data in a different order than the Vanilla counterpart and more like the note message \, where the pitch comes first., f 81;
#X msg 128 269 160 \, 60 \, 0;
#X msg 114 246 160 \, 69 \, 127;
#X text 212 245 Key Aftertouch in channel 1 \, key (60) \, Aftertouch (127);
#X text 212 268 Key Aftertouch in channel 1 \, key (60) \, Aftertouch (0);
#X text 183 376 Pitch (key) and Aftertouch;
#X obj 114 372 display 8;
#X connect 6 0 13 0;
#X connect 6 1 1 0;
#X connect 8 0 6 0;
#X connect 9 0 6 0;
#X restore 761 285 pd Polyphonic-Aftertouch;
#N canvas 507 233 670 423 Channel-Aftertouch 0;
#X text 250 332 MIDI channel;
#X obj 227 329 display;
#X text 55 43 They start with a first number from 208 to 223 that codifies the MIDI Channel (208 is channel 1 \, 209 is channel 2 and so on)., f 79;
#X text 55 77 The following byte represents the Channel Aftertouch (from 0 to 127)., f 79;
#X obj 132 301 touch.in, f 14;
#X text 163 373 Aftertouch;
#X msg 132 231 208 \, 127;
#X text 197 231 Channel Aftertouch in channel 1 \, Aftertouch (127);
#X obj 132 370 display 3;
#X msg 146 264 219 \, 0;
#X text 197 265 Channel Aftertouch in channel 12 \, Aftertouch (0);
#X text 55 169 Pd Vanilla has [touchin] and ELSE has [touch.in] (that retrieves aftertouch messages from raw MIDI input)., f 79;
#X text 55 101 This is simpler version of Polyphnic Aftertouch that we'll see next and is a more common feature of current controllers \, where all keys of the keyboard will activate a single aftertouch parameter for the whole channel \, where the highest aftertouch in the channel prevails., f 79;
#X text 55 20 Channel Aftertouch (or "pressure") messages are composed of 2 bytes., f 79;
#X connect 4 0 8 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X connect 9 0 4 0;
#X restore 585 285 pd Channel-Aftertouch;
#N canvas 329 156 951 470 System-messages 0;
#X text 83 94 240 - Start of sysex Messages, f 54;
#X text 83 111 241 - MIDI Time Code, f 54;
#X text 83 145 243 - Song Select, f 54;
#X text 83 180 246 - Tune Request. Upon receiving a Tune Request \, all analog synthesizers should tune their oscillators;
#X text 83 211 247 - End of sysex Messages, f 54;
#X text 83 162 244 & 245 - Undefined (reserved), f 54;
#X obj 795 119 sysexin;
#X text 29 21 Here's a table with the byte values and corresponding messages., f 35;
#X text 83 128 242 - Song Position Pointer, f 54;
#X text 63 72 System Common and System Exclusive Messages (240-247):;
#X text 65 244 System Real Time Messages (248-254);
#X text 83 276 248 - clock, f 26;
#X text 83 310 250 - start, f 26;
#X text 83 327 251 - continue, f 26;
#X text 83 344 252 - stop, f 26;
#X text 83 361 253 - undefined, f 26;
#X text 83 378 254 - Active Sensing, f 26;
#X text 83 395 255 - Reset, f 26;
#X text 83 293 249 - undefined (reserved);
#X text 521 15 Sysex messages allows a computer to communicate with external MIDI-compatible devices \, such as backing up patch data from a synthesizer to a computer's hard drive. Pd vanilla has [sysexin] to retrieve this sequence of bytes. Sysex messages start with 240 and end with 247 \, but can have any other values in between as a list of any length., f 53;
#X text 560 415 clock;
#X text 616 414 start;
#X text 666 414 continue;
#X text 733 414 stop;
#X text 785 415 active;
#X text 843 414 reset;
#X obj 570 229 midirealtimein;
#X obj 570 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 626 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 683 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 740 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 797 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 854 395 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X text 783 427 sensing;
#X msg 584 260 248;
#X msg 617 260 250;
#X msg 622 289 251;
#X msg 655 289 252;
#X msg 662 318 254;
#X msg 699 318 255;
#X obj 570 362 sysrt.in, f 41;
#X text 522 153 The realtime messages are only retrieven in Pd by the [midirealtimein] object. The [sysrt.in] object from the ELSE library deals with them., f 53;
#X connect 26 0 40 0;
#X connect 34 0 40 0;
#X connect 35 0 40 0;
#X connect 36 0 40 0;
#X connect 37 0 40 0;
#X connect 38 0 40 0;
#X connect 39 0 40 0;
#X connect 40 0 27 0;
#X connect 40 1 28 0;
#X connect 40 2 29 0;
#X connect 40 3 30 0;
#X connect 40 4 31 0;
#X connect 40 5 32 0;
#X restore 725 451 pd System-messages;
#X text 26 15 MIDI messages are composed of a stream of byte messages. A byte is the same as 8 bits \, so this means that the possible values are 2ˆ8 (two to the power of 8). This gives us 256 possible values (from 0 to 255). Therefore \, MIDI messages is a sequence of numbers in the 0 to 255 range., f 67;
#X text 26 91 The main MIDI messages are: Control Change / Program Change / Channel Aftertouch / Polyphonic Aftertouch / Pitch Bend / Note On & Note Off. The values that correspond to these parameters (such as pitch and velocity) are within the range between 0 to 127! Thus \, they have a 7 bits resolution. The exception is pitch bend messages \, that uses 2 numbers from 0 to 127 to represent its value \, hence it has 14-bit resolution (from 0 to 16383)., f 67;
#X text 26 196 Here we'll see all of these messages in details \, and also others called "system messages" (such as Sysex and Real-time)., f 67;
#X text 26 232 For the cited main MIDI messages \, besides the value \, we also have a MIDI Channel. We have 16 possible MIDI Channels in the MIDI Protocol (which is usually a number from 1 to 16 by a standard)., f 67;
#X text 26 280 Values above 127 codify the MIDI message type and MIDI channel. For instance \, a number of 128 means we have a Note Off message for channel 1 \, 129 is "Note Off to channel 2: \, and so on until 143 (Note Off message to channel 16). The number 144 belongs to a new group of MIDI messages (Note on) \, and this is how they go. Below \, we have the different type of messages listed by value:, f 67;
#X text 531 60 Note On \, Note Off \, Poliphonic Aftertouch \, Control Change and Pitch Bend messages need to be followed by two more values. In Note On or Note Off \, these represent Pitch and Velocuty. For Polyphnic Aftertouch \, we need Pitch and Aftertouch value. For Control Change we have Control Number and Control Value. For Pitch Bend \, as stated before \, two values will codify a Pitch Bend value with 14-bits resolution., f 62;
#X text 532 380 We still have messages from 240 to 255 to deal with so called "System Messages". These are: "System Common Messages" \, "System Real Time Messages" and "System Exclusive Messages" (or "sysex"). Let's check them out:, f 65;
#X text 56 377 - 128 to 143: Note Off message in channels 1-16 \; - 144 to 159: Note On message in channels 1-16 \; - 160 to 175: Polyphonic Aftertouch in channels 1-16 \; - 176 to 191: Control Change messages in channels 1-16 \; - 192 to 207: Program Change messages in channels 1-16 \; - 208 to 223: Channel Aftertouch in channels 1-16 \; - 224 to 239: Pitch Bend messages in channels 1-16;
