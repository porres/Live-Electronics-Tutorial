#N canvas 321 54 950 586 12;
#X declare -path else;
#X obj 140 386 *~;
#X obj 402 485 *~;
#X obj 420 454 *~;
#X obj 402 515 delwrite~ \$0-Kp 1000;
#X floatatom 420 384 5 0 0 0 - - - 0;
#X obj 423 363 hsl 128 15 0 1 0 0 empty \$0-fb empty -2 -8 0 10 #dcdcdc
#000000 #000000 0 1;
#X text 455 362 feedback;
#X floatatom 624 377 0 0 0 0 - - - 0;
#X obj 627 350 hsl 128 15 0 1 0 0 empty \$0-blend empty -2 -8 0 10
#dcdcdc #000000 #000000 0 1;
#X text 669 349 blend;
#X obj 494 410 noise~;
#X obj 494 458 expr~ if($v1 < $v2 \, 1 \, -1), f 19;
#X text 68 388 envelope;
#X obj 270 506 out~;
#X obj 270 424 mov.avg~ 2;
#X obj 494 434 rescale~;
#X obj 420 409 f2s~ 10;
#X obj 158 354 timed.gate~;
#X text 340 355 ms;
#X obj 270 385 delread4~ \$0-Kp;
#X obj 270 324 expr~ 1000 / $v1;
#X obj 624 403 f2s~ 10;
#X obj 681 460 initmess \; \$0-fb 0.98 \; \$0-blend 1;
#X text 47 115 For the feedback \, the ideal would be to do it in a
subpatch with a block size of 1 \, for very high frequencies. We'll
do this later., f 55;
#X text 47 168 An important detail is that we have now is a mean filter
of two samples inside the feedback loop \, this is a lowpass (high
cut) filter. The original algorithm also describes a "blend" parameter
which alters the feedback value., f 55;
#X text 468 135 A negative feedback promotes inversion of the polarity
for each iteration \, which makes it sound an octave lower \, besides
changing the harmonic content.;
#X text 468 56 The original feedback happens for a blend of 1 \, 0
gives us a negative feedback. Values towards 0.5 insert random changes
between 0 and 1 \, 0.5 being white noise (and noise is what it sounds
like) - this noisiness was aimed to emulate more percussive sounds.
, f 58;
#X obj 270 299 rand.i~ 50 500;
#X obj 706 21 declare -path else;
#X text 472 194 The Karplus Strong algorithm is from the late 70s and
is the simplest case of Physical Modeling. More precisely \, an example
of Waveguide Synthesis. Despite being simple \, it can achieve good
results modeling plucked instruments., f 58;
#X text 473 266 As a kind of Waveguide model \, the Karplus-Strong
is considered a "Wavetable Modification" algorithm \, for at each iteration
\, the sound clip gets filtered and modified., f 58;
#X obj 270 275 tempo~ -on 60 100;
#X obj 270 357 numbox~ 6 12 100 #C0C0C4 #440008 10 0 0 0;
#X obj 140 282 white~ -clip;
#X text 46 52 Let's now closely recreate the original Karplus-Strong
algorithm. Its noise input consisted only in 1 or -1 values stored
in a table \, so we're using a clipped white noise from [white~] instead.
, f 55;
#X connect 0 0 14 0;
#X connect 1 0 3 0;
#X connect 2 0 1 1;
#X connect 4 0 16 0;
#X connect 5 0 4 0;
#X connect 7 0 21 0;
#X connect 8 0 7 0;
#X connect 10 0 15 0;
#X connect 11 0 2 1;
#X connect 14 0 1 0;
#X connect 14 0 13 0;
#X connect 15 0 11 0;
#X connect 16 0 2 0;
#X connect 17 0 0 1;
#X connect 19 0 14 0;
#X connect 20 0 17 1;
#X connect 20 0 32 0;
#X connect 21 0 11 1;
#X connect 27 0 20 0;
#X connect 31 0 17 0;
#X connect 31 0 27 0;
#X connect 32 0 19 0;
#X connect 33 0 0 0;
